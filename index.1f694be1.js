const t=new class{constructor(t){this.initialState=t||[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],this.size=4,this.board=this.initialState.map(t=>t.slice()),this.score=0,this.status="idle"}moveLeft(){let t=!1;if("playing"===this.status){for(let e=0;e<this.size;e++){let s=this.board[e].filter(t=>0!==t);for(let t=0;t<s.length-1;t++)s[t]===s[t+1]&&(s[t]*=2,s[t+1]=0,this.score+=s[t]);for(s=s.filter(t=>0!==t);s.length<this.size;)s.push(0);this.board[e].join("")!==s.join("")&&(t=!0),this.board[e]=s}t&&this.postMoved()}}reverseRows(){this.board.forEach(t=>t.reverse())}moveRight(){this.reverseRows(),this.moveLeft(),this.reverseRows()}transpose(){this.board=this.board[0].map((t,e)=>this.board.map(t=>t[e]))}moveUp(){this.transpose(),this.moveLeft(),this.transpose()}moveDown(){this.transpose(),this.moveRight(),this.transpose()}addRandom(){let t=[];for(let e=0;e<this.size;e++)for(let s=0;s<this.size;s++)0===this.board[e][s]&&t.push({x:e,y:s});if(0===t.length)return null;let{x:e,y:s}=t[Math.floor(Math.random()*t.length)];this.board[e][s]=.9>Math.random()?2:4}postMoved(){this.addRandom(),this.checkWin()&&(this.status="win"),this.checkLose()&&(this.status="lose")}checkWin(){return this.board.some(t=>t.includes(2048))}checkLose(){for(let t=0;t<this.size;t++)for(let e=0;e<this.size;e++)if(0===this.board[t][e]||t>0&&this.board[t][e]===this.board[t-1][e]||e>0&&this.board[t][e]===this.board[t][e-1]||t<this.size-1&&this.board[t][e]===this.board[t+1][e]||e<this.size-1&&this.board[t][e]===this.board[t][e+1])return!1;return!0}getScore(){return this.score}getState(){return this.board}getStatus(){return this.status}start(){this.board=this.initialState.map(t=>t.slice()),this.status="playing",this.score=0,this.addRandom(),this.addRandom()}restart(){this.board=this.initialState.map(t=>t.slice()),this.status="idle",this.score=0}},e=document.querySelector(".button.start"),s=document.querySelector(".game-score"),i=document.querySelector(".game-field"),r=document.querySelector(".message-win"),o=document.querySelector(".message-lose"),a=document.querySelector(".message-start");function h(){let e=t.getState(),r=i.querySelectorAll(".field-row");e.forEach((e,i)=>{let o=r[i].querySelectorAll(".field-cell");e.forEach((t,e)=>{o[e].textContent=0===t?"":t,o[e].className=`field-cell field-cell--${t}`}),s.textContent=t.getScore()})}function d(){let s=t.getStatus();r.classList.add("hidden"),o.classList.add("hidden"),a.classList.add("hidden"),"idle"===s&&a.classList.remove("hidden"),"win"===s&&r.classList.remove("hidden"),"lose"===s&&o.classList.remove("hidden"),"playing"===s&&(e.classList.remove("start"),e.classList.add("restart"),e.textContent="Restart")}document.addEventListener("keydown",function(e){if("playing"===t.getStatus()){switch(e.key){case"ArrowLeft":t.moveLeft();break;case"ArrowRight":t.moveRight();break;case"ArrowUp":t.moveUp();break;case"ArrowDown":t.moveDown();break;default:return}h(),d()}}),e.addEventListener("click",()=>{t.start(),h(),d()}),h(),d();
//# sourceMappingURL=index.1f694be1.js.map
